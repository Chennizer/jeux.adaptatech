<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Face with Blue Tears - p5.js</title>
  <script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.min.js"></script>
</head>
<body>
<script>
let tears = [];

function setup() {
  createCanvas(800, 600);
  for (let i = 0; i < 120; i++) {
    tears.push(new Tear(random(['left', 'right'])));
  }
  strokeJoin(ROUND);
}

function draw() {
  background(255); // white
  drawFace();
  for (let t of tears) {
    t.update();
    t.show();
  }
}

function drawFace() {
  push();
  translate(width / 2, height / 2);

  stroke(0);
  noFill();

  // Head outline (big "grand plan" face)
  strokeWeight(3);
  ellipse(0, 0, 260, 340);

  // Jaw and chin (extra contour)
  arc(0, 60, 220, 180, PI + QUARTER_PI, TWO_PI - QUARTER_PI);

  // Nose
  strokeWeight(2);
  line(0, -40, -5, 10);
  arc(-5, 15, 20, 16, 0, PI);

  // Eyes (just above center)
  let eyeY = -40;
  let eyeOffsetX = 80;

  // Left eye
  strokeWeight(2.2);
  arc(-eyeOffsetX, eyeY, 60, 28, 0, PI);
  // Lower lid hint
  arc(-eyeOffsetX, eyeY + 4, 40, 16, PI, TWO_PI);

  // Right eye
  arc(eyeOffsetX, eyeY, 60, 28, 0, PI);
  arc(eyeOffsetX, eyeY + 4, 40, 16, PI, TWO_PI);

  // Pupils (simple abstract dots)
  fill(0);
  noStroke();
  circle(-eyeOffsetX, eyeY, 6);
  circle(eyeOffsetX, eyeY, 6);

  // Eyebrows
  noFill();
  stroke(0);
  strokeWeight(3);
  arc(-eyeOffsetX, eyeY - 25, 80, 30, PI + 0.4, TWO_PI - 0.2);
  arc(eyeOffsetX, eyeY - 25, 80, 30, PI + 0.2, TWO_PI - 0.4);

  // Mouth
  strokeWeight(2.5);
  let mouthY = 60;
  arc(0, mouthY, 90, 40, 0.1 * PI, 0.9 * PI); // neutral / slightly sad
  // Under-lip shadow line
  strokeWeight(1.5);
  arc(0, mouthY + 15, 60, 20, 0.1 * PI, 0.9 * PI);

  // Minimal neck lines
  strokeWeight(2);
  line(-40, 150, -30, 220);
  line(40, 150, 30, 220);

  pop();
}

// Tear particle class
class Tear {
  constructor(side) {
    this.side = side;
    this.reset(true);
  }

  reset(first = false) {
    // Eye positions (must match drawFace)
    const eyeYCanvas = height / 2 - 40;
    const eyeOffsetX = 80;

    if (this.side === 'left') {
      this.baseX = width / 2 - eyeOffsetX;
    } else {
      this.baseX = width / 2 + eyeOffsetX;
    }

    this.y = first
      ? random(eyeYCanvas, height + 40)
      : eyeYCanvas;

    this.speed = random(1.5, 3);
    this.noiseOffset = random(1000);
    this.size = random(8, 14);
  }

  update() {
    this.y += this.speed;

    // Horizontal sway using Perlin noise
    const sway = map(
      noise(this.noiseOffset + this.y * 0.005),
      0, 1,
      -6, 6
    );

    this.x = this.baseX + sway;

    if (this.y > height + 30) {
      this.reset();
    }
  }

  show() {
    noStroke();
    fill(60, 140, 255, 210); // blue tears, slightly transparent
    ellipse(this.x, this.y, this.size * 0.8, this.size * 1.2);
  }
}
</script>
</body>
</html>
