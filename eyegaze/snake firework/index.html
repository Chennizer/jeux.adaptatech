<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeu feu d'artifice contrôle oculaire EMB</title>
    <link rel="stylesheet" href="../../css/global.css">
    <link rel="stylesheet" href="../../css/layout.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/games.css">
    <link rel="stylesheet" href="../../css/otherswitch.css">
</head>
<body class="game">

<!-- Control Panel -->
<div id="control-panel" class="control-panel" style="display:none;">
    <div id="control-panel-title" class="control-panel-title" style="color: white;">
        Feux d'artifice
    </div>

    <div id="control-panel-instructions" class="control-panel-instructions" style="color: white;">
        Ajustez les paramètres ci-dessous pour commencer à créer des feux d'artifice. 
    </div>

    <!-- Options Container -->
    <div id="control-panel-options" class="control-panel-options">
        <label for="interval-input" style="color: black;">Intervalle entre les cercles (secondes) :</label>
        <input id="interval-input" type="number" value="10" min="1">

        <!-- Input for initial circle count -->
        <label for="initial-circles-input" style="color: black;">Nombre de cercles initiaux :</label>
        <input id="initial-circles-input" type="number" value="5" min="0">
    </div>

    <!-- Start Button styled with consistency -->
    <div id="button-container" class="button-container">
        <button id="control-panel-start-button" class="button">Commencer</button>
    </div>

    <!-- Control Panel Tips -->
    <div id="control-panel-tips" class="control-panel-tips">
        <p style="color: white;">F11 ou FN+F11 pour le plein écran. F5 pour revenir à cette page.</p>
    </div>
</div>

<div id="promptOverlay">
    <button id="infoButton" title="More info" class="translate" data-fr="ⓘ" data-en="ⓘ">ⓘ</button>
    <p class="translate" data-fr="Survolez les cercles pour déclencher des feux d'artifice" data-en="Hover circles to trigger fireworks">Survolez les cercles pour déclencher des feux d'artifice</p>
    <button id="startButton" class="translate" data-fr="Commencer" data-en="Start">Commencer</button>
</div>

<div id="infoModal" style="display: none;">
    <p class="translate" data-fr="Jeu de feux d'artifice au contrôle oculaire" data-en="Eye-gaze fireworks game">Jeu de feux d'artifice au contrôle oculaire</p>
    <button id="closeModal" class="translate" data-fr="Fermer" data-en="Close">Fermer</button>
</div>

<div id="settings-icon" title="Settings" class="translate" data-fr="⚙️" data-en="⚙️">⚙️</div>
<div id="menu">
    <h2 data-fr="Options" data-en="Options">Options</h2>
    <label>
        <span data-fr="Intervalle (s)" data-en="Interval (s)">Intervalle (s)</span>
        <span id="intervalVal">10</span>
        <input type="range" id="intervalSlider" min="1" max="20" value="10">
    </label>
    <label>
        <span data-fr="Cercles initiaux" data-en="Initial circles">Cercles initiaux</span>
        <span id="initialVal">5</span>
        <input type="range" id="initialSlider" min="0" max="20" value="5">
    </label>
</div>

<!-- Explosion sound -->
<audio id="explosionSound" src="../../sounds/firework.mp3" preload="auto"></audio>

<script src="../../js/firework.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
    const overlay = document.getElementById('promptOverlay');
    const startBtn = document.getElementById('startButton');
    const hiddenStart = document.getElementById('control-panel-start-button');
    const settingsIcon = document.getElementById('settings-icon');
    const menu = document.getElementById('menu');
    const infoBtn = document.getElementById('infoButton');
    const infoModal = document.getElementById('infoModal');
    const closeModal = document.getElementById('closeModal');
    const intervalSlider = document.getElementById('intervalSlider');
    const intervalVal = document.getElementById('intervalVal');
    const intervalInput = document.getElementById('interval-input');
    const initialSlider = document.getElementById('initialSlider');
    const initialVal = document.getElementById('initialVal');
    const initialInput = document.getElementById('initial-circles-input');
    let menuTimer;

    intervalSlider.addEventListener('input', e => {
        intervalVal.textContent = e.target.value;
        intervalInput.value = e.target.value;
        resetMenuTimer();
    });
    initialSlider.addEventListener('input', e => {
        initialVal.textContent = e.target.value;
        initialInput.value = e.target.value;
        resetMenuTimer();
    });

    startBtn.addEventListener('pointerup', e => {
        e.preventDefault();
        overlay.remove();
        if (typeof fullscreen === 'function') fullscreen(true);
        hiddenStart.click();
        settingsIcon.style.display = 'flex';
    });

    infoBtn.addEventListener('click', () => infoModal.style.display = 'block');
    closeModal.addEventListener('click', () => infoModal.style.display = 'none');

    settingsIcon.addEventListener('pointerup', () => {
        if (menu.classList.contains('show')) {
            hideMenu();
        } else {
            menu.classList.add('show');
            startMenuTimer();
        }
    });

    document.addEventListener('click', e => {
        if (!menu.contains(e.target) && !settingsIcon.contains(e.target)) {
            hideMenu();
        }
    });

    function startMenuTimer() {
        clearTimeout(menuTimer);
        menuTimer = setTimeout(hideMenu, 8000);
    }

    function resetMenuTimer() {
        if (menu.classList.contains('show')) {
            startMenuTimer();
        }
    }

    function hideMenu() {
        menu.classList.remove('show');
        clearTimeout(menuTimer);
    }
});
</script>
<script src="../../js/translationonly.js"></script>
</body>
</html>
