<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bee Harmony – Cause & Effect</title>
  <style>
    :root {
      --bg-start: #0b1120;
      --bg-end: #1e293b;
      --accent: #fbbf24;
      --accent-strong: #f59e0b;
      --text: #f8fafc;
      --muted: #cbd5e1;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Baloo 2", "Nunito", system-ui, -apple-system, sans-serif;
      background: radial-gradient(circle at 20% 20%, rgba(251, 191, 36, 0.06), transparent 35%),
        radial-gradient(circle at 80% 30%, rgba(59, 130, 246, 0.08), transparent 40%),
        linear-gradient(160deg, var(--bg-start), var(--bg-end));
      color: var(--text);
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    header {
      padding: 1.25rem 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
      background: rgba(15, 23, 42, 0.75);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid rgba(148, 163, 184, 0.25);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.25);
      z-index: 10;
    }

    header h1 {
      font-size: clamp(1.3rem, 2vw, 1.8rem);
      letter-spacing: 0.01em;
    }

    header p {
      color: var(--muted);
      font-size: 1rem;
      line-height: 1.4;
    }

    .cta-row {
      display: flex;
      align-items: center;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .cta-button {
      appearance: none;
      border: none;
      background: linear-gradient(120deg, #facc15, #f97316);
      color: #0b1120;
      font-weight: 700;
      letter-spacing: 0.02em;
      padding: 0.85rem 1.35rem;
      border-radius: 999px;
      font-size: 1.05rem;
      cursor: pointer;
      box-shadow: 0 10px 30px rgba(251, 191, 36, 0.4);
      transition: transform 0.15s ease, box-shadow 0.15s ease, filter 0.2s ease;
    }

    .cta-button:active,
    .cta-button:focus-visible {
      transform: scale(0.98);
      box-shadow: 0 6px 18px rgba(251, 191, 36, 0.3);
      outline: 3px solid rgba(251, 191, 36, 0.6);
      outline-offset: 4px;
    }

    .cta-hint {
      color: var(--muted);
      font-size: 1rem;
    }

    main {
      position: relative;
      flex: 1;
    }

    #scene {
      width: 100%;
      height: 100%;
      display: block;
    }

    .status {
      position: absolute;
      left: 50%;
      bottom: 1rem;
      transform: translateX(-50%);
      background: rgba(15, 23, 42, 0.75);
      padding: 0.75rem 1.1rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.35);
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--muted);
      pointer-events: none;
    }

    .pulse-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #f97316;
      box-shadow: 0 0 12px rgba(249, 115, 22, 0.9);
      animation: pulse 1.5s ease-in-out infinite;
    }

    @keyframes pulse {
      0% { transform: scale(0.9); opacity: 0.6; }
      50% { transform: scale(1.15); opacity: 1; }
      100% { transform: scale(0.9); opacity: 0.6; }
    }

    @media (max-width: 640px) {
      header {
        padding: 1rem;
      }
      .cta-row {
        flex-direction: column;
        align-items: flex-start;
      }
      .cta-button {
        width: 100%;
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Bee Harmony – Cause & Effect</h1>
    <p>Press the big button, hit the space bar, or tap anywhere. Watch the bees travel to the flowers and bring home glowing honey.</p>
    <div class="cta-row">
      <button class="cta-button" id="goButton">Send the bees ✨</button>
      <div class="cta-hint">Space / tap / click all work.</div>
    </div>
  </header>

  <main>
    <canvas id="scene" aria-label="Bee cause and effect game"></canvas>
    <div class="status"><span class="pulse-dot"></span><span id="statusText">Ready to play</span></div>
  </main>

  <script>
    const canvas = document.getElementById("scene");
    const ctx = canvas.getContext("2d");
    const statusText = document.getElementById("statusText");
    const goButton = document.getElementById("goButton");

    const bees = [];
    const sparkles = [];
    let honeyFill = 0;
    let targetFill = 0;
    let lastTime = performance.now();
    let flightCooldown = 0;

    function resize() {
      const rect = canvas.getBoundingClientRect();
      const ratio = window.devicePixelRatio || 1;
      canvas.width = rect.width * ratio;
      canvas.height = rect.height * ratio;
      ctx.setTransform(ratio, 0, 0, ratio, 0, 0);
    }

    window.addEventListener("resize", resize);
    resize();

    function hivePos() {
      return { x: canvas.width / (window.devicePixelRatio || 1) * 0.22, y: canvas.height / (window.devicePixelRatio || 1) * 0.55 };
    }

    function flowerPos() {
      return { x: canvas.width / (window.devicePixelRatio || 1) * 0.78, y: canvas.height / (window.devicePixelRatio || 1) * 0.45 };
    }

    function createBees() {
      bees.length = 0;
      const hive = hivePos();
      const count = 6;
      for (let i = 0; i < count; i++) {
        bees.push({
          x: hive.x + Math.random() * 12 - 6,
          y: hive.y + Math.random() * 12 - 6,
          phase: Math.random() * Math.PI * 2,
          state: "idle", // idle, toFlower, toHive
          progress: 0,
        });
      }
    }

    createBees();

    function drawBackground() {
      const w = canvas.width / (window.devicePixelRatio || 1);
      const h = canvas.height / (window.devicePixelRatio || 1);

      const sky = ctx.createLinearGradient(0, 0, 0, h);
      sky.addColorStop(0, "#0b1226");
      sky.addColorStop(1, "#0f172a");
      ctx.fillStyle = sky;
      ctx.fillRect(0, 0, w, h);

      const ground = ctx.createLinearGradient(0, h * 0.6, 0, h);
      ground.addColorStop(0, "#0f2f1d");
      ground.addColorStop(1, "#0b1f12");
      ctx.fillStyle = ground;
      ctx.fillRect(0, h * 0.6, w, h * 0.4);

      // soft sun glow
      const sun = ctx.createRadialGradient(w * 0.8, h * 0.15, 20, w * 0.8, h * 0.15, 180);
      sun.addColorStop(0, "rgba(250, 204, 21, 0.4)");
      sun.addColorStop(1, "rgba(250, 204, 21, 0)");
      ctx.fillStyle = sun;
      ctx.beginPath();
      ctx.arc(w * 0.8, h * 0.15, 180, 0, Math.PI * 2);
      ctx.fill();
    }

    function drawHive(fill) {
      const { x, y } = hivePos();
      const radius = Math.min(canvas.width, canvas.height) / (window.devicePixelRatio || 1) * 0.08;

      // base
      const baseGrad = ctx.createLinearGradient(x - radius, y - radius, x + radius, y + radius);
      baseGrad.addColorStop(0, "#5b3b06");
      baseGrad.addColorStop(1, "#8d5b12");
      ctx.fillStyle = baseGrad;
      ctx.beginPath();
      ctx.roundRect(x - radius * 1.05, y - radius * 0.75, radius * 2.1, radius * 1.5, radius * 0.25);
      ctx.fill();

      // honey cells
      const cellCount = 5;
      for (let i = 0; i < cellCount; i++) {
        const px = x - radius * 0.6 + (i % 3) * radius * 0.55;
        const py = y - radius * 0.35 + Math.floor(i / 3) * radius * 0.65;
        const glow = fill * Math.min(1, (i + 1) / cellCount);
        ctx.beginPath();
        ctx.roundRect(px, py, radius * 0.5, radius * 0.45, 8);
        ctx.fillStyle = `rgba(251, 191, 36, ${0.35 + glow * 0.6})`;
        ctx.fill();
        ctx.strokeStyle = "rgba(255, 236, 179, 0.8)";
        ctx.lineWidth = 1.2;
        ctx.stroke();
      }

      // doorway
      ctx.fillStyle = "#0b1120";
      ctx.beginPath();
      ctx.roundRect(x - radius * 0.22, y + radius * 0.05, radius * 0.45, radius * 0.32, 6);
      ctx.fill();

      // glow
      const glow = ctx.createRadialGradient(x, y, radius * 0.4, x, y, radius * 1.8);
      glow.addColorStop(0, `rgba(251, 191, 36, ${0.35 + fill * 0.3})`);
      glow.addColorStop(1, "rgba(251, 191, 36, 0)");
      ctx.fillStyle = glow;
      ctx.beginPath();
      ctx.arc(x, y, radius * 1.8, 0, Math.PI * 2);
      ctx.fill();
    }

    function drawFlower() {
      const { x, y } = flowerPos();
      const radius = Math.min(canvas.width, canvas.height) / (window.devicePixelRatio || 1) * 0.07;

      // stem
      ctx.strokeStyle = "#2dd4bf";
      ctx.lineWidth = radius * 0.18;
      ctx.lineCap = "round";
      ctx.beginPath();
      ctx.moveTo(x, y + radius * 0.2);
      ctx.lineTo(x, y + radius * 1.5);
      ctx.stroke();

      // petals
      const petalCount = 7;
      for (let i = 0; i < petalCount; i++) {
        const ang = (Math.PI * 2 * i) / petalCount + Math.sin(lastTime * 0.001 + i) * 0.05;
        const px = x + Math.cos(ang) * radius;
        const py = y + Math.sin(ang) * radius;
        ctx.fillStyle = `hsla(${30 + i * 18}, 85%, 62%, 0.9)`;
        ctx.beginPath();
        ctx.ellipse(px, py, radius * 0.55, radius * 0.35, ang, 0, Math.PI * 2);
        ctx.fill();
      }

      // center
      ctx.fillStyle = "#fef9c3";
      ctx.beginPath();
      ctx.arc(x, y, radius * 0.55, 0, Math.PI * 2);
      ctx.fill();
    }

    function drawBee(bee, dt) {
      const buzzing = bee.state === "idle";
      const wobble = Math.sin(bee.phase + lastTime * 0.005) * (buzzing ? 3 : 1.5);
      const size = 18;

      ctx.save();
      ctx.translate(bee.x, bee.y + wobble);
      ctx.rotate(Math.sin(bee.phase) * 0.1 + (bee.state === "toFlower" ? 0.2 : bee.state === "toHive" ? -0.2 : 0));

      // glow
      const glowRad = buzzing ? size * 1.2 : size * 1.4;
      const glowGrad = ctx.createRadialGradient(0, 0, 0, 0, 0, glowRad);
      glowGrad.addColorStop(0, "rgba(251, 191, 36, 0.65)");
      glowGrad.addColorStop(1, "rgba(251, 191, 36, 0)");
      ctx.fillStyle = glowGrad;
      ctx.beginPath();
      ctx.arc(0, 0, glowRad, 0, Math.PI * 2);
      ctx.fill();

      // body
      const gradient = ctx.createLinearGradient(-size, 0, size, 0);
      gradient.addColorStop(0, "#facc15");
      gradient.addColorStop(0.6, "#78350f");
      ctx.fillStyle = gradient;
      ctx.beginPath();
      ctx.ellipse(0, 0, size * 0.8, size * 0.55, 0, 0, Math.PI * 2);
      ctx.fill();

      // stripes
      ctx.strokeStyle = "rgba(15, 23, 42, 0.95)";
      ctx.lineWidth = 3;
      ctx.beginPath();
      ctx.moveTo(-size * 0.25, -size * 0.6);
      ctx.lineTo(-size * 0.25, size * 0.6);
      ctx.moveTo(size * 0.15, -size * 0.55);
      ctx.lineTo(size * 0.15, size * 0.55);
      ctx.stroke();

      // head
      ctx.fillStyle = "#0b1120";
      ctx.beginPath();
      ctx.arc(size * 0.9, 0, size * 0.4, 0, Math.PI * 2);
      ctx.fill();

      // eye
      ctx.fillStyle = "#f8fafc";
      ctx.beginPath();
      ctx.arc(size * 1.05, -size * 0.1, size * 0.13, 0, Math.PI * 2);
      ctx.fill();

      // wings
      const flap = Math.sin(lastTime * 0.02 + bee.phase) * 0.25;
      ctx.globalAlpha = 0.8;
      ctx.fillStyle = "rgba(191, 219, 254, 0.9)";
      ctx.beginPath();
      ctx.ellipse(-size * 0.2, -size * 0.8, size * 0.35, size * 0.55, -0.5 + flap, 0, Math.PI * 2);
      ctx.fill();
      ctx.beginPath();
      ctx.ellipse(-size * 0.2, size * 0.8, size * 0.35, size * 0.55, 0.5 - flap, 0, Math.PI * 2);
      ctx.fill();
      ctx.globalAlpha = 1;

      ctx.restore();
    }

    function drawSparkles() {
      for (const s of sparkles) {
        const a = Math.max(0, s.life / s.maxLife);
        ctx.fillStyle = `rgba(255, 255, 255, ${a})`;
        ctx.beginPath();
        ctx.arc(s.x, s.y, 3 + (1 - a) * 5, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function updateSparkles(dt) {
      for (const s of sparkles) {
        s.life -= dt;
        s.x += s.vx * dt;
        s.y += s.vy * dt;
      }
      for (let i = sparkles.length - 1; i >= 0; i--) {
        if (sparkles[i].life <= 0) sparkles.splice(i, 1);
      }
    }

    function spawnBurst(x, y) {
      for (let i = 0; i < 14; i++) {
        const ang = (Math.PI * 2 * i) / 14 + Math.random() * 0.3;
        const speed = 50 + Math.random() * 50;
        sparkles.push({
          x,
          y,
          vx: Math.cos(ang) * speed,
          vy: Math.sin(ang) * speed,
          life: 1.2,
          maxLife: 1.2,
        });
      }
    }

    function triggerFlight() {
      if (flightCooldown > 0) return;
      const hive = hivePos();
      const flower = flowerPos();
      bees.forEach((bee, idx) => {
        bee.state = "toFlower";
        bee.progress = 0;
        bee.offset = Math.random() * 0.08 + idx * 0.02;
        bee.start = { ...hive };
        bee.end = {
          x: flower.x + Math.random() * 30 - 15,
          y: flower.y + Math.random() * 25 - 12,
        };
      });
      targetFill = Math.min(1, targetFill + 0.2);
      flightCooldown = 0.8;
      statusText.textContent = "Bees collecting nectar...";
    }

    function updateBees(dt) {
      const hive = hivePos();
      bees.forEach((bee) => {
        if (bee.state === "idle") {
          bee.phase += dt * 2;
          bee.x = hive.x + Math.sin(bee.phase * 1.3) * 22;
          bee.y = hive.y + Math.cos(bee.phase) * 12;
          return;
        }

        bee.progress += dt * (bee.state === "toFlower" ? 0.6 : 0.75);
        const t = Math.min(1, bee.progress);
        const ease = t * t * (3 - 2 * t);
        const target = bee.state === "toFlower" ? bee.end : hive;
        const start = bee.state === "toFlower" ? bee.start : bee.end;

        bee.x = start.x + (target.x - start.x) * ease;
        bee.y = start.y + (target.y - start.y) * ease + Math.sin(t * Math.PI * 2) * 6;

        if (t >= 1) {
          if (bee.state === "toFlower") {
            spawnBurst(bee.x, bee.y);
            bee.state = "toHive";
            bee.progress = 0;
          } else {
            spawnBurst(bee.x, bee.y);
            bee.state = "idle";
            bee.progress = 0;
          }
        }
      });
    }

    function update(dt) {
      flightCooldown = Math.max(0, flightCooldown - dt);
      honeyFill += (targetFill - honeyFill) * Math.min(1, dt * 3);
      updateBees(dt);
      updateSparkles(dt);
    }

    function draw() {
      drawBackground();
      drawHive(honeyFill);
      drawFlower();
      bees.forEach((bee) => drawBee(bee));
      drawSparkles();
    }

    function loop(now) {
      const dt = Math.min((now - lastTime) / 1000, 0.05);
      lastTime = now;
      update(dt);
      draw();
      requestAnimationFrame(loop);
    }

    requestAnimationFrame(loop);

    goButton.addEventListener("click", triggerFlight);
    window.addEventListener("pointerdown", triggerFlight);
    window.addEventListener("keydown", (e) => {
      if (e.code === "Space") {
        e.preventDefault();
        triggerFlight();
      }
    });

    // gentle reminder text updates
    setInterval(() => {
      if (flightCooldown === 0) {
        statusText.textContent = "Press, tap, or hit space to send the bees.";
      }
    }, 4000);
  </script>
</body>
</html>
