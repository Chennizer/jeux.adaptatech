<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calm Construction: Eye Gaze Building Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #2a3c7f);
            color: #f0f8ff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            width: 100%;
            max-width: 900px;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            color: #a3d9ff;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #c9e6ff;
            margin-bottom: 25px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.5;
        }
        
        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 900px;
            gap: 25px;
        }
        
        .game-area {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 25px;
            width: 100%;
        }
        
        .construction-zone {
            flex: 1;
            min-width: 300px;
            background-color: rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(163, 217, 255, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .construction-zone h2 {
            color: #a3d9ff;
            margin-bottom: 20px;
            font-size: 1.8rem;
            text-align: center;
        }
        
        #building-area {
            width: 100%;
            height: 400px;
            background-color: rgba(30, 40, 100, 0.4);
            border-radius: 15px;
            position: relative;
            overflow: hidden;
            border: 3px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column-reverse;
            align-items: center;
            justify-content: flex-start;
            padding-bottom: 20px;
        }
        
        .block {
            position: relative;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            margin-top: 5px;
        }
        
        .block:hover {
            transform: scale(1.05);
        }
        
        .block.active {
            animation: pulse-glow 1.5s infinite alternate;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.7);
        }
        
        @keyframes pulse-glow {
            0% { box-shadow: 0 0 10px rgba(255, 255, 255, 0.5); }
            100% { box-shadow: 0 0 25px rgba(255, 255, 255, 0.9); }
        }
        
        .control-panel {
            flex: 1;
            min-width: 300px;
            background-color: rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(163, 217, 255, 0.2);
            display: flex;
            flex-direction: column;
        }
        
        .control-panel h2 {
            color: #a3d9ff;
            margin-bottom: 20px;
            font-size: 1.8rem;
            text-align: center;
        }
        
        .settings {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .setting-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .setting-group label {
            font-size: 1.1rem;
            color: #c9e6ff;
        }
        
        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .slider-value {
            min-width: 40px;
            text-align: center;
            font-weight: bold;
            color: #a3d9ff;
        }
        
        input[type="range"] {
            flex: 1;
            height: 10px;
            -webkit-appearance: none;
            appearance: none;
            background: rgba(163, 217, 255, 0.2);
            border-radius: 5px;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: #a3d9ff;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        .color-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .color-option {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.2s;
        }
        
        .color-option.selected {
            border-color: white;
            transform: scale(1.1);
        }
        
        .game-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 15px;
        }
        
        button {
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        #start-btn {
            background: linear-gradient(to right, #4CAF50, #45a049);
            color: white;
            flex: 1;
        }
        
        #reset-btn {
            background: linear-gradient(to right, #f44336, #d32f2f);
            color: white;
            flex: 1;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .stats-panel {
            background-color: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 20px;
            width: 100%;
            max-width: 900px;
            margin-top: 10px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
            border: 2px solid rgba(163, 217, 255, 0.1);
        }
        
        .stat {
            text-align: center;
            min-width: 150px;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #a3d9ff;
            line-height: 1;
        }
        
        .stat-label {
            font-size: 1rem;
            color: #c9e6ff;
            margin-top: 5px;
        }
        
        .instructions {
            background-color: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 20px;
            width: 100%;
            max-width: 900px;
            margin-top: 10px;
            border: 2px solid rgba(163, 217, 255, 0.1);
        }
        
        .instructions h3 {
            color: #a3d9ff;
            margin-bottom: 10px;
            font-size: 1.4rem;
        }
        
        .instructions p {
            line-height: 1.6;
            margin-bottom: 10px;
        }
        
        .instructions ul {
            margin-left: 20px;
            margin-bottom: 10px;
        }
        
        .instructions li {
            line-height: 1.6;
            margin-bottom: 5px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: rgba(76, 175, 80, 0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.5s ease;
            max-width: 300px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .eye-pointer {
            position: absolute;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: rgba(255, 50, 50, 0.7);
            pointer-events: none;
            z-index: 100;
            transition: transform 0.1s;
            display: none;
        }
        
        .eye-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }
        
        .eye-toggle {
            background: linear-gradient(to right, #2196F3, #1976D2);
            color: white;
        }
        
        @media (max-width: 768px) {
            .game-area {
                flex-direction: column;
            }
            
            .construction-zone, .control-panel {
                min-width: 100%;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .stats-panel {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
        }
        
        .completion-celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.8s;
        }
        
        .completion-celebration.show {
            opacity: 1;
            pointer-events: all;
        }
        
        .celebration-content {
            text-align: center;
            max-width: 600px;
            padding: 40px;
            background: linear-gradient(135deg, #1a2a6c, #2a3c7f);
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
            border: 3px solid #a3d9ff;
        }
        
        .celebration-content h2 {
            font-size: 3rem;
            color: #a3d9ff;
            margin-bottom: 20px;
        }
        
        .celebration-content p {
            font-size: 1.3rem;
            margin-bottom: 30px;
            line-height: 1.5;
        }
        
        .confetti {
            position: absolute;
            width: 15px;
            height: 15px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Calm Construction</h1>
        <p class="subtitle">An eye gaze building game designed for students with profound intellectual disabilities. Build structures by gazing at the glowing blocks!</p>
    </div>
    
    <div class="game-container">
        <div class="game-area">
            <div class="construction-zone">
                <h2>Construction Site</h2>
                <div id="building-area">
                    <!-- Blocks will be dynamically added here -->
                </div>
            </div>
            
            <div class="control-panel">
                <h2>Game Controls</h2>
                <div class="settings">
                    <div class="setting-group">
                        <label for="dwell-time">Dwell Time (seconds):</label>
                        <div class="slider-container">
                            <input type="range" id="dwell-time" min="1" max="5" step="0.5" value="2">
                            <span class="slider-value" id="dwell-value">2.0</span>
                        </div>
                    </div>
                    
                    <div class="setting-group">
                        <label>Block Color:</label>
                        <div class="color-selector">
                            <div class="color-option selected" style="background-color: #4CAF50;" data-color="#4CAF50"></div>
                            <div class="color-option" style="background-color: #2196F3;" data-color="#2196F3"></div>
                            <div class="color-option" style="background-color: #FF9800;" data-color="#FF9800"></div>
                            <div class="color-option" style="background-color: #9C27B0;" data-color="#9C27B0"></div>
                            <div class="color-option" style="background-color: #FF5722;" data-color="#FF5722"></div>
                        </div>
                    </div>
                    
                    <div class="setting-group">
                        <label>Game Mode:</label>
                        <div class="eye-controls">
                            <button id="mouse-mode" class="eye-toggle">Mouse Mode</button>
                            <button id="eye-mode" class="eye-toggle">Eye Gaze Simulation</button>
                        </div>
                    </div>
                </div>
                
                <div class="game-controls">
                    <button id="start-btn">Start Building</button>
                    <button id="reset-btn">Reset Tower</button>
                </div>
            </div>
        </div>
        
        <div class="stats-panel">
            <div class="stat">
                <div class="stat-value" id="blocks-count">0</div>
                <div class="stat-label">Blocks Added</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="tower-height">0</div>
                <div class="stat-label">Tower Height</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="completion">0%</div>
                <div class="stat-label">Completion</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="time-active">0s</div>
                <div class="stat-label">Active Time</div>
            </div>
        </div>
        
        <div class="instructions">
            <h3>How to Play</h3>
            <p>Welcome to Calm Construction! This game is specially designed for eye gaze users:</p>
            <ul>
                <li><strong>Mouse Mode:</strong> Move your mouse to control the pointer and hover over the glowing block.</li>
                <li><strong>Eye Gaze Simulation:</strong> Click "Eye Gaze Simulation" to control the pointer with your mouse clicks (simulating eye gaze fixation).</li>
                <li><strong>Build:</strong> Look at the glowing block until the timer completes. A new block will be added to your structure!</li>
                <li><strong>Settings:</strong> Adjust the dwell time (how long you need to look at the block) and choose your favorite block color.</li>
            </ul>
            <p>The game is designed to be calming and rewarding, with positive feedback for every block added. No time pressure, no penalties - just satisfying construction!</p>
        </div>
    </div>
    
    <div class="eye-pointer" id="eye-pointer"></div>
    
    <div class="notification" id="notification">
        <div id="notification-text">Block added successfully!</div>
    </div>
    
    <div class="completion-celebration" id="completion-celebration">
        <div class="celebration-content">
            <h2>Amazing Construction!</h2>
            <p>You've successfully built a magnificent tower with <span id="final-blocks">0</span> blocks!</p>
            <p>Your calm focus and steady gaze created something wonderful.</p>
            <button id="celebrate-again" style="margin-top: 20px; padding: 15px 30px; font-size: 1.2rem;">Build Again!</button>
        </div>
    </div>
    
    <script>
        // Game state variables
        let gameActive = false;
        let blocksCount = 0;
        let towerHeight = 0;
        let startTime = null;
        let timerInterval = null;
        let activeBlock = null;
        let dwellTime = 2.0;
        let blockColor = "#4CAF50";
        let eyeGazeMode = false;
        let eyePointerActive = false;
        let eyePointerX = 0;
        let eyePointerY = 0;
        
        // DOM elements
        const buildingArea = document.getElementById('building-area');
        const blocksCountElement = document.getElementById('blocks-count');
        const towerHeightElement = document.getElementById('tower-height');
        const completionElement = document.getElementById('completion');
        const timeActiveElement = document.getElementById('time-active');
        const startBtn = document.getElementById('start-btn');
        const resetBtn = document.getElementById('reset-btn');
        const dwellTimeSlider = document.getElementById('dwell-time');
        const dwellValueElement = document.getElementById('dwell-value');
        const colorOptions = document.querySelectorAll('.color-option');
        const mouseModeBtn = document.getElementById('mouse-mode');
        const eyeModeBtn = document.getElementById('eye-mode');
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notification-text');
        const eyePointer = document.getElementById('eye-pointer');
        const completionCelebration = document.getElementById('completion-celebration');
        const finalBlocksElement = document.getElementById('final-blocks');
        const celebrateAgainBtn = document.getElementById('celebrate-again');
        
        // Game constants
        const MAX_BLOCKS = 10;
        const BLOCK_WIDTH = 120;
        const BLOCK_HEIGHT = 60;
        const COLORS = [
            "#4CAF50", // Green
            "#2196F3", // Blue
            "#FF9800", // Orange
            "#9C27B0", // Purple
            "#FF5722"  // Red
        ];
        
        // Initialize the game
        function initGame() {
            updateStats();
            setupEventListeners();
            createInitialBlocks();
            
            // Set up mouse movement tracking for eye gaze simulation
            document.addEventListener('mousemove', (e) => {
                if (eyePointerActive) {
                    eyePointerX = e.clientX;
                    eyePointerY = e.clientY;
                    eyePointer.style.left = (eyePointerX - 15) + 'px';
                    eyePointer.style.top = (eyePointerY - 15) + 'px';
                }
            });
            
            // Set up click for eye gaze simulation
            document.addEventListener('click', (e) => {
                if (eyeGazeMode && eyePointerActive) {
                    // Simulate eye gaze fixation by clicking
                    eyePointerX = e.clientX;
                    eyePointerY = e.clientY;
                    eyePointer.style.left = (eyePointerX - 15) + 'px';
                    eyePointer.style.top = (eyePointerY - 15) + 'px';
                    
                    // Check if we clicked on the active block
                    if (activeBlock && gameActive) {
                        const blockRect = activeBlock.getBoundingClientRect();
                        if (
                            eyePointerX >= blockRect.left &&
                            eyePointerX <= blockRect.right &&
                            eyePointerY >= blockRect.top &&
                            eyePointerY <= blockRect.bottom
                        ) {
                            addBlockToTower();
                        }
                    }
                }
            });
        }
        
        // Set up all event listeners
        function setupEventListeners() {
            startBtn.addEventListener('click', toggleGame);
            resetBtn.addEventListener('click', resetGame);
            
            dwellTimeSlider.addEventListener('input', function() {
                dwellTime = parseFloat(this.value);
                dwellValueElement.textContent = dwellTime.toFixed(1);
                
                if (gameActive && activeBlock) {
                    resetActiveBlockTimer();
                }
            });
            
            colorOptions.forEach(option => {
                option.addEventListener('click', function() {
                    colorOptions.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    blockColor = this.getAttribute('data-color');
                    
                    // Update color of existing blocks
                    document.querySelectorAll('.block').forEach(block => {
                        if (!block.classList.contains('active')) {
                            block.style.backgroundColor = blockColor;
                        }
                    });
                });
            });
            
            mouseModeBtn.addEventListener('click', function() {
                eyeGazeMode = false;
                eyePointerActive = false;
                eyePointer.style.display = 'none';
                mouseModeBtn.style.background = 'linear-gradient(to right, #4CAF50, #45a049)';
                eyeModeBtn.style.background = 'linear-gradient(to right, #2196F3, #1976D2)';
                showNotification("Mouse mode activated. Move mouse to control pointer.");
            });
            
            eyeModeBtn.addEventListener('click', function() {
                eyeGazeMode = true;
                eyePointerActive = true;
                eyePointer.style.display = 'block';
                mouseModeBtn.style.background = 'linear-gradient(to right, #2196F3, #1976D2)';
                eyeModeBtn.style.background = 'linear-gradient(to right, #4CAF50, #45a049)';
                showNotification("Eye gaze simulation mode. Click to simulate eye fixation.");
            });
            
            celebrateAgainBtn.addEventListener('click', function() {
                completionCelebration.classList.remove('show');
                resetGame();
                toggleGame();
            });
        }
        
        // Create initial placeholder blocks
        function createInitialBlocks() {
            buildingArea.innerHTML = '';
            
            // Add a base platform
            const base = document.createElement('div');
            base.className = 'block';
            base.style.width = '300px';
            base.style.height = '40px';
            base.style.backgroundColor = '#795548';
            base.style.marginBottom = '10px';
            buildingArea.appendChild(base);
        }
        
        // Toggle game state
        function toggleGame() {
            if (!gameActive) {
                startGame();
            } else {
                pauseGame();
            }
        }
        
        // Start the game
        function startGame() {
            gameActive = true;
            startBtn.textContent = 'Pause Building';
            startBtn.style.background = 'linear-gradient(to right, #FF9800, #F57C00)';
            startTime = new Date();
            
            // Start the timer
            timerInterval = setInterval(updateTimer, 1000);
            
            // Create the first active block
            createActiveBlock();
            
            showNotification("Game started! Look at the glowing block to add it to your tower.");
        }
        
        // Pause the game
        function pauseGame() {
            gameActive = false;
            startBtn.textContent = 'Resume Building';
            startBtn.style.background = 'linear-gradient(to right, #4CAF50, #45a049)';
            
            // Clear the timer
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            
            // Remove active block glow
            if (activeBlock) {
                activeBlock.classList.remove('active');
                activeBlock.innerHTML = '';
            }
            
            showNotification("Game paused. Click 'Resume Building' to continue.");
        }
        
        // Reset the game
        function resetGame() {
            gameActive = false;
            startBtn.textContent = 'Start Building';
            startBtn.style.background = 'linear-gradient(to right, #4CAF50, #45a049)';
            blocksCount = 0;
            towerHeight = 0;
            
            // Clear the timer
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            
            // Remove all blocks except the base
            createInitialBlocks();
            
            // Reset stats
            updateStats();
            
            showNotification("Tower reset. Ready to build again!");
        }
        
        // Create a new active block for the user to gaze at
        function createActiveBlock() {
            if (!gameActive) return;
            
            // Remove previous active block if exists
            if (activeBlock) {
                activeBlock.classList.remove('active');
                activeBlock.innerHTML = '';
            }
            
            // Create new active block
            activeBlock = document.createElement('div');
            activeBlock.className = 'block active';
            activeBlock.style.width = BLOCK_WIDTH + 'px';
            activeBlock.style.height = BLOCK_HEIGHT + 'px';
            activeBlock.style.backgroundColor = blockColor;
            activeBlock.style.marginTop = '20px';
            
            // Add timer visual
            const timerVisual = document.createElement('div');
            timerVisual.className = 'timer-visual';
            timerVisual.style.width = '0%';
            timerVisual.style.height = '10px';
            timerVisual.style.backgroundColor = '#FFFFFF';
            timerVisual.style.borderRadius = '5px';
            timerVisual.style.marginTop = '10px';
            timerVisual.style.transition = `width ${dwellTime}s linear`;
            
            activeBlock.appendChild(timerVisual);
            buildingArea.appendChild(activeBlock);
            
            // Set up hover detection for mouse mode
            if (!eyeGazeMode) {
                let hoverTimer = null;
                
                activeBlock.addEventListener('mouseenter', function() {
                    if (!gameActive) return;
                    
                    // Start the timer visual
                    timerVisual.style.width = '100%';
                    
                    // Set timeout to add block after dwell time
                    hoverTimer = setTimeout(() => {
                        addBlockToTower();
                    }, dwellTime * 1000);
                });
                
                activeBlock.addEventListener('mouseleave', function() {
                    if (!gameActive) return;
                    
                    // Reset the timer visual
                    timerVisual.style.width = '0%';
                    
                    // Clear the timeout
                    if (hoverTimer) {
                        clearTimeout(hoverTimer);
                        hoverTimer = null;
                    }
                });
            }
            
            // For eye gaze mode, the timer is handled by the click simulation
        }
        
        // Reset the active block timer (when settings change)
        function resetActiveBlockTimer() {
            if (activeBlock && gameActive) {
                const timerVisual = activeBlock.querySelector('.timer-visual');
                if (timerVisual) {
                    timerVisual.style.transition = 'none';
                    timerVisual.style.width = '0%';
                    
                    // Force reflow
                    void timerVisual.offsetWidth;
                    
                    timerVisual.style.transition = `width ${dwellTime}s linear`;
                }
            }
        }
        
        // Add a block to the tower
        function addBlockToTower() {
            if (!gameActive) return;
            
            // Create a new block for the tower
            const towerBlock = document.createElement('div');
            towerBlock.className = 'block';
            towerBlock.style.width = BLOCK_WIDTH + 'px';
            towerBlock.style.height = BLOCK_HEIGHT + 'px';
            towerBlock.style.backgroundColor = blockColor;
            towerBlock.style.marginTop = '5px';
            
            // Add the block to the top of the tower
            buildingArea.insertBefore(towerBlock, buildingArea.firstChild);
            
            // Update game stats
            blocksCount++;
            towerHeight += BLOCK_HEIGHT;
            
            // Check for completion
            if (blocksCount >= MAX_BLOCKS) {
                completeGame();
            } else {
                // Create next active block
                createActiveBlock();
                
                // Show success notification
                showNotification(`Block ${blocksCount} added! Keep going!`);
                
                // Add a satisfying sound effect (using Web Audio API)
                playSuccessSound();
                
                // Update stats
                updateStats();
            }
        }
        
        // Complete the game
        function completeGame() {
            gameActive = false;
            startBtn.textContent = 'Start Building';
            startBtn.style.background = 'linear-gradient(to right, #4CAF50, #45a049)';
            
            // Clear the timer
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            
            // Show celebration
            finalBlocksElement.textContent = blocksCount;
            completionCelebration.classList.add('show');
            createConfetti();
            
            // Play celebration sound
            playCelebrationSound();
            
            showNotification("Congratulations! You've built an amazing tower!");
        }
        
        // Update game statistics
        function updateStats() {
            blocksCountElement.textContent = blocksCount;
            towerHeightElement.textContent = towerHeight + 'px';
            
            const completionPercentage = Math.min(100, Math.round((blocksCount / MAX_BLOCKS) * 100));
            completionElement.textContent = completionPercentage + '%';
            
            // Update time active
            if (startTime && gameActive) {
                const now = new Date();
                const seconds = Math.floor((now - startTime) / 1000);
                timeActiveElement.textContent = seconds + 's';
            }
        }
        
        // Update the timer display
        function updateTimer() {
            updateStats();
        }
        
        // Show a notification
        function showNotification(message) {
            notificationText.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Play a success sound
        function playSuccessSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
                oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1); // E5
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.3);
            } catch (e) {
                // Sound not supported in this browser
                console.log("Audio not supported");
            }
        }
        
        // Play a celebration sound
        function playCelebrationSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Play a chord
                const notes = [523.25, 659.25, 783.99]; // C5, E5, G5
                
                notes.forEach((freq, index) => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);
                    
                    gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                    gainNode.gain.linearRampToValueAtTime(0.1, audioContext.currentTime + 0.1 + (index * 0.05));
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.0);
                    
                    oscillator.start(audioContext.currentTime + (index * 0.05));
                    oscillator.stop(audioContext.currentTime + 1.0);
                });
            } catch (e) {
                // Sound not supported in this browser
                console.log("Audio not supported");
            }
        }
        
        // Create confetti for celebration
        function createConfetti() {
            const colors = ['#FF9800', '#4CAF50', '#2196F3', '#9C27B0', '#FF5722', '#FFEB3B'];
            
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.top = '-20px';
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                
                document.body.appendChild(confetti);
                
                // Animate confetti falling
                const animation = confetti.animate([
                    { transform: `translate(0, 0) rotate(0deg)`, opacity: 1 },
                    { transform: `translate(${Math.random() * 100 - 50}px, 100vh) rotate(${Math.random() * 720}deg)`, opacity: 0 }
                ], {
                    duration: 3000 + Math.random() * 2000,
                    easing: 'cubic-bezier(0.215, 0.61, 0.355, 1)'
                });
                
                // Remove confetti after animation
                animation.onfinish = () => {
                    confetti.remove();
                };
            }
        }
        
        // Initialize the game when page loads
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>