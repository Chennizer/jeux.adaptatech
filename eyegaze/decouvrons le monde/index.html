<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explorons le monde</title>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="../../css/global.css">
    <link rel="stylesheet" href="../../css/layout.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/games.css">
    <link rel="stylesheet" href="../../css/otherswitch.css">
</head>
<body class="interactive-map">

    <!-- Control Panel Section -->
    <div id="control-panel" class="control-panel" style="display:none;">
        <div id="control-panel-title" class="control-panel-title" style="color: white;">Découvrons le monde!</div>
        <div id="control-panel-instructions" class="control-panel-instructions" style="color: white;">
            Cliquez sur le bouton ci-dessous pour commencer le jeu. Appuyez sur F11 ou FN + F11 pour passer en plein écran.
        </div>

        <div id="control-panel-options" class="control-panel-options">
            <label for="dwell-time-input" style="color: white;">Temps de fixation (ms) :</label>
            <input id="dwell-time-input" type="number" placeholder="Entrer le temps de fixation (ms)" value="1500">
        </div>

        <div id="button-container" class="button-container">
            <div id="control-panel-loading-bar-container" class="control-panel-loading-bar-container">
                <div id="control-panel-loading-bar" class="control-panel-loading-bar"></div>
            </div>
            <!-- Updated button to match other button styles -->
            <button id="control-panel-start-button" class="button">Commencer</button>
        </div>
    </div>

    <div id="promptOverlay">
        <button id="infoButton" title="More info" class="translate" data-fr="ⓘ" data-en="ⓘ">ⓘ</button>
        <p class="translate" data-fr="Fixez une région de la carte pour lancer sa vidéo" data-en="Gaze at a region to play its video">Fixez une région de la carte pour lancer sa vidéo</p>
        <button id="startButton" class="translate" data-fr="Commencer" data-en="Start">Commencer</button>
    </div>

    <div id="infoModal" style="display: none;">
        <p class="translate" data-fr="Jeu de découverte par contrôle oculaire." data-en="Eye-gaze discovery game.">Jeu de découverte par contrôle oculaire.</p>
        <button id="closeModal" class="translate" data-fr="Fermer" data-en="Close">Fermer</button>
    </div>

    <div id="settings-icon" title="Settings" class="translate" data-fr="⚙️" data-en="⚙️">⚙️</div>
    <div id="menu">
        <h2 data-fr="Options" data-en="Options">Options</h2>
        <h3 data-fr="Temps de fixation" data-en="Dwell time">Temps de fixation</h3>
        <label>
            <span data-fr="Délai (ms)" data-en="Delay (ms)">Délai (ms)</span>
            <span id="dwellVal">1500</span>
            <input type="range" id="dwellSlider" min="500" max="5000" value="1500">
        </label>
    </div>

    <!-- Map Container -->
    <div class="map-container" id="map-container">
        <img src="../../images/worldmap.jpg" usemap="#image-map" alt="World Map" class="world-map">
        <div id="hover-circle" class="dwell-circle"></div>
    </div>

    <!-- Overlay for Dwell Effects -->
    <div class="overlay" id="overlay"></div>

    <!-- Animation Container for Region-Specific Animations -->
    <div id="animation-container" class="animation-container">
        <img id="zone-animation" src="" alt="Zone Animation" class="zone-animation">
    </div>

    <!-- Video Container for Displaying Region-Specific Videos -->
    <div id="video-container" class="video-container">
        <video id="end-video" controls>
            <source id="video-source" src="" type="video/mp4">
            Votre navigateur ne prend pas en charge la balise vidéo.
        </video>
    </div>

    <!-- Image Map for the Continent Zones -->
    <map name="image-map">
        <area target="" alt="north-america" title="Amérique du Nord" href="#" coords="442,530,369,480,260,419,191,256,42,214,167,71,476,34,857,24" shape="poly">
        <area target="" alt="south-america" title="Amérique du Sud" href="#" coords="437,545,450,686,528,940,583,986,650,806,712,647,644,560,522,487" shape="poly">
        <area target="" alt="africa" title="Afrique" href="#" coords="835,346,778,509,907,589,993,854,1161,774,1181,636,1154,582,1198,491,1064,362,949,322" shape="poly">
        <area target="" alt="europe" title="Europe" href="#" coords="1273,63,983,25,818,241,834,339,912,316,1041,343,1103,297,1163,314,1236,221" shape="poly">
        <area target="" alt="asia" title="Asie" href="#" coords="1899,137,1476,49,1271,83,1242,226,1175,316,1081,314,1085,375,1203,491,1326,535,1436,599,1521,657,1604,599" shape="poly">
        <area target="" alt="oceania" title="Océanie" href="#" coords="1743,608,1617,586,1522,718,1476,752,1482,857,1561,844,1607,928,1712,976,1783,905" shape="poly">
    </map>

    <!-- Image Map Resizer Script -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/image-map-resizer/1.0.10/js/imageMapResizer.min.js"></script>

    <!-- Main Game Script -->
    <script src="../../js/scripts.js"></script>

    <!-- Game Initialization Script -->
    <script>
        setupInteractiveMapGame({
            dwellTimeInputSelector: '#dwell-time-input',
            zoneEffects: {
                'north-america': { video: '../../videos/north-america.mp4' },
                'south-america': { video: '../../videos/south-america.mp4' },
                'africa': { video: '../../videos/africa.mp4' },
                'europe': { video: '../../videos/europe.mp4' },
                'asia': { video: '../../videos/asia.mp4' },
                'oceania': { video: '../../videos/oceania.mp4' }
            }
        });
    </script>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const overlay = document.getElementById('promptOverlay');
        const startBtn = document.getElementById('startButton');
        const hiddenStart = document.getElementById('control-panel-start-button');
        const settingsIcon = document.getElementById('settings-icon');
        const menu = document.getElementById('menu');
        const infoBtn = document.getElementById('infoButton');
        const infoModal = document.getElementById('infoModal');
        const closeModal = document.getElementById('closeModal');
        const dwellSlider = document.getElementById('dwellSlider');
        const dwellVal = document.getElementById('dwellVal');
        const dwellInput = document.getElementById('dwell-time-input');
        let menuTimer;

        dwellSlider.addEventListener('input', e => {
            dwellVal.textContent = e.target.value;
            dwellInput.value = e.target.value;
            resetMenuTimer();
        });

        startBtn.addEventListener('pointerup', e => {
            e.preventDefault();
            overlay.remove();
            if (typeof fullscreen === 'function') fullscreen(true);
            hiddenStart.click();
            settingsIcon.style.display = 'flex';
        });

        infoBtn.addEventListener('click', () => infoModal.style.display = 'block');
        closeModal.addEventListener('click', () => infoModal.style.display = 'none');

        settingsIcon.addEventListener('pointerup', () => {
            if (menu.classList.contains('show')) {
                hideMenu();
            } else {
                menu.classList.add('show');
                startMenuTimer();
            }
        });

        document.addEventListener('click', e => {
            if (!menu.contains(e.target) && !settingsIcon.contains(e.target)) {
                hideMenu();
            }
        });

        function startMenuTimer() {
            clearTimeout(menuTimer);
            menuTimer = setTimeout(hideMenu, 8000);
        }

        function resetMenuTimer() {
            if (menu.classList.contains('show')) {
                startMenuTimer();
            }
        }

        function hideMenu() {
            menu.classList.remove('show');
            clearTimeout(menuTimer);
        }
    });
    </script>
    <script src="../../js/translationonly.js"></script>
</body>
</html>
